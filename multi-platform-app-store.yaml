apiVersion: v1
kind: ConfigMap
metadata:
  name: working-console
  namespace: opendirectory
data:
  index.html: |
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>OpenDirectory MDM</title>
        <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
        <style>
            * { margin: 0; padding: 0; box-sizing: border-box; }
            body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: #f8fafc; }
            
            .sidebar { 
                position: fixed; left: 0; top: 0; height: 100vh; width: 250px; 
                background: #1e293b; color: white; padding: 1rem; z-index: 100;
                transition: transform 0.3s ease;
            }
            
            .main-content { margin-left: 250px; min-height: 100vh; }
            
            .header { 
                background: white; padding: 1rem 2rem; border-bottom: 1px solid #e2e8f0; 
                display: flex; justify-content: space-between; align-items: center;
            }
            
            .container { padding: 2rem; }
            
            .nav-item { 
                display: flex; align-items: center; padding: 0.75rem; margin: 0.5rem 0; 
                border-radius: 6px; cursor: pointer; transition: background 0.2s;
            }
            .nav-item:hover { background: rgba(255,255,255,0.1); }
            .nav-item.active { background: #3b82f6; }
            .nav-item i { margin-right: 0.75rem; width: 20px; }
            
            .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 1.5rem; }
            .card { 
                background: white; border-radius: 12px; padding: 1.5rem; 
                box-shadow: 0 1px 3px rgba(0,0,0,0.1); border: 1px solid #e2e8f0;
            }
            
            .app-card {
                background: white; border-radius: 12px; padding: 1.5rem;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1); border: 1px solid #e2e8f0;
                transition: all 0.3s ease;
            }
            .app-card:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            }
            
            .stat-card { text-align: center; }
            .stat-number { font-size: 2.5rem; font-weight: bold; color: #3b82f6; margin-bottom: 0.5rem; }
            .stat-label { color: #64748b; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.05em; }
            
            .btn { 
                padding: 0.75rem 1.5rem; border-radius: 6px; border: none; font-weight: 500; 
                cursor: pointer; transition: all 0.2s; text-decoration: none; display: inline-block;
            }
            .btn-primary { background: #3b82f6; color: white; }
            .btn-primary:hover { background: #2563eb; }
            .btn-success { background: #10b981; color: white; }
            .btn-warning { background: #f59e0b; color: white; }
            .btn-danger { background: #ef4444; color: white; }
            .btn-secondary { background: #6b7280; color: white; }
            
            .platform-badge { 
                padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; 
                font-weight: 500; margin-right: 0.5rem; display: inline-block;
            }
            .platform-windows { background: #0078d4; color: white; }
            .platform-macos { background: #000000; color: white; }
            .platform-linux { background: #ff6600; color: white; }
            .platform-universal { background: #10b981; color: white; }
            
            .app-header {
                display: flex; justify-content: space-between; align-items: flex-start;
                margin-bottom: 1rem;
            }
            
            .app-icon {
                width: 48px; height: 48px; border-radius: 8px; margin-right: 1rem;
                background: linear-gradient(135deg, #3b82f6, #1e40af);
                display: flex; align-items: center; justify-content: center;
                color: white; font-size: 1.5rem;
            }
            
            .app-info {
                flex: 1;
            }
            
            .app-name {
                font-size: 1.25rem; font-weight: 600; color: #1d1d1f; margin-bottom: 0.5rem;
            }
            
            .app-version {
                color: #64748b; font-size: 0.875rem; margin-bottom: 0.5rem;
            }
            
            .app-description {
                color: #64748b; font-size: 0.875rem; line-height: 1.4;
            }
            
            .app-platforms {
                margin: 1rem 0;
            }
            
            .app-stats {
                display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem;
                margin: 1rem 0; padding: 1rem; background: #f8fafc; border-radius: 8px;
            }
            
            .stat-item {
                text-align: center;
            }
            
            .stat-value {
                font-size: 1.5rem; font-weight: bold; color: #1d1d1f; margin-bottom: 0.25rem;
            }
            
            .stat-desc {
                font-size: 0.75rem; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px;
            }
            
            .app-actions {
                display: flex; gap: 0.5rem; margin-top: 1.5rem;
            }
            
            .filter-bar {
                display: flex; gap: 1rem; margin-bottom: 2rem; align-items: center;
                background: white; padding: 1rem; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            
            .filter-group {
                display: flex; flex-direction: column; gap: 0.5rem;
            }
            
            .filter-label {
                font-size: 0.875rem; font-weight: 500; color: #374151;
            }
            
            .filter-select {
                padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 6px; 
                background: white; cursor: pointer;
            }
            
            .category-section {
                margin-bottom: 3rem;
            }
            
            .category-header {
                display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1.5rem;
            }
            
            .category-title {
                font-size: 1.5rem; font-weight: 600; color: #1d1d1f;
            }
            
            .category-count {
                background: #e2e8f0; color: #374151; padding: 0.25rem 0.75rem; 
                border-radius: 12px; font-size: 0.875rem; font-weight: 500;
            }
            
            .modal { 
                position: fixed; top: 0; left: 0; right: 0; bottom: 0; 
                background: rgba(0,0,0,0.5); z-index: 1000; 
                display: flex; align-items: center; justify-content: center;
            }
            .modal-content { 
                background: white; padding: 2rem; border-radius: 12px; 
                max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto;
            }

            .device-card {
                border: 1px solid #e2e8f0;
                border-radius: 12px;
                padding: 1.5rem;
                margin-bottom: 1rem;
                background: white;
                transition: all 0.2s ease;
            }
            .device-card:hover {
                border-color: #3b82f6;
                box-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);
            }
            .device-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 1rem;
            }
            .device-info {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 1rem;
                margin-top: 1rem;
            }

            .device-group {
                border: 2px solid #e2e8f0;
                border-radius: 12px;
                margin-bottom: 2rem;
                overflow: hidden;
            }
            .group-header {
                background: #f8fafc;
                padding: 1rem 1.5rem;
                border-bottom: 1px solid #e2e8f0;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            .group-content {
                padding: 1rem;
            }

            .info-item {
                display: flex;
                flex-direction: column;
            }
            .info-label {
                color: #64748b;
                font-size: 0.875rem;
                margin-bottom: 0.25rem;
            }
            .info-value {
                font-weight: 500;
                color: #374151;
            }

            .installed-apps {
                margin-top: 1rem;
                padding-top: 1rem;
                border-top: 1px solid #e2e8f0;
            }
            .app-list {
                display: flex;
                flex-wrap: wrap;
                gap: 0.5rem;
                margin-top: 0.5rem;
            }
            .app-installed { background: #dcfce7; color: #166534; }
            .app-update-available { background: #fef3c7; color: #92400e; }
            .update-indicator {
                margin-left: 0.25rem;
                background: #f59e0b;
                color: white;
                border-radius: 50%;
                width: 16px;
                height: 16px;
                display: inline-flex;
                align-items: center;
                justify-content: center;
                font-size: 10px;
            }

            .user-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
                gap: 1rem;
                margin-top: 1rem;
            }
            .user-card {
                border: 1px solid #e2e8f0;
                border-radius: 8px;
                padding: 1rem;
                background: white;
                transition: all 0.2s ease;
            }
            .user-card:hover {
                border-color: #3b82f6;
                box-shadow: 0 2px 8px rgba(59, 130, 246, 0.1);
            }
            .user-header {
                display: flex;
                align-items: center;
                gap: 0.75rem;
                margin-bottom: 0.75rem;
            }
            .user-avatar {
                width: 40px;
                height: 40px;
                background: #3b82f6;
                color: white;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: bold;
                font-size: 0.875rem;
            }
            .user-info {
                flex: 1;
            }
            .user-details {
                margin-bottom: 1rem;
                font-size: 0.875rem;
            }
            .detail-item {
                display: flex;
                justify-content: space-between;
                margin-bottom: 0.25rem;
            }
            .detail-label {
                color: #64748b;
            }
            .detail-value {
                color: #374151;
                font-weight: 500;
            }
            .user-actions {
                display: flex;
                gap: 0.5rem;
            }

            .group-badge {
                padding: 0.25rem 0.75rem;
                border-radius: 12px;
                font-size: 0.75rem;
                font-weight: 500;
                text-transform: uppercase;
                margin-left: 0.5rem;
            }
            .group-servers { background: #dbeafe; color: #1e40af; }
            .group-workstations { background: #dcfce7; color: #166534; }
            .group-printers { background: #fef3c7; color: #92400e; }
            .group-mobile { background: #f3e8ff; color: #7c3aed; }
            .group-iot { background: #fee2e2; color: #991b1b; }
            
            .deployment-options {
                display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1rem 0;
            }
            
            .deployment-card {
                border: 2px solid #e2e8f0; border-radius: 8px; padding: 1rem;
                cursor: pointer; transition: all 0.3s ease;
            }
            
            .deployment-card:hover {
                border-color: #3b82f6; background: #f8fafc;
            }
            
            .deployment-card.selected {
                border-color: #3b82f6; background: #eff6ff;
            }
            
            .hidden { display: none; }
            
            .notification {
                position: fixed; top: 20px; right: 20px; padding: 1rem 1.5rem;
                border-radius: 8px; color: white; font-weight: 500; z-index: 3000;
                transform: translateX(400px); transition: transform 0.3s ease;
            }
            .notification.show { transform: translateX(0); }
            .notification.success { background: #10b981; }
            .notification.error { background: #ef4444; }
        </style>
    </head>
    <body>
        <div id="app">
            <!-- Sidebar -->
            <div class="sidebar">
                <div style="margin-bottom: 2rem;">
                    <h2><i class="fas fa-shield-alt"></i> OpenDirectory</h2>
                    <p style="color: #94a3b8; font-size: 0.875rem;">Enterprise MDM</p>
                </div>
                
                <nav>
                    <div class="nav-item" :class="{active: currentView === 'dashboard'}" @click="setView('dashboard')">
                        <i class="fas fa-tachometer-alt"></i> Dashboard
                    </div>
                    <div class="nav-item" :class="{active: currentView === 'devices'}" @click="setView('devices')">
                        <i class="fas fa-mobile-alt"></i> Devices
                    </div>
                    <div class="nav-item" :class="{active: currentView === 'users'}" @click="setView('users')">
                        <i class="fas fa-users"></i> Users
                    </div>
                    <div class="nav-item" :class="{active: currentView === 'apps'}" @click="setView('apps')">
                        <i class="fas fa-cube"></i> Application Store
                    </div>
                    <div class="nav-item" :class="{active: currentView === 'policies'}" @click="setView('policies')">
                        <i class="fas fa-clipboard-list"></i> Policies
                    </div>
                    <div class="nav-item" :class="{active: currentView === 'compliance'}" @click="setView('compliance')">
                        <i class="fas fa-check-circle"></i> Compliance
                    </div>
                    <div class="nav-item" @click="window.open('http://192.168.1.223:30300', '_blank')">
                        <i class="fas fa-chart-line"></i> Monitoring
                    </div>
                    <div class="nav-item" @click="window.open('http://192.168.1.223:30170', '_blank')">
                        <i class="fas fa-directory"></i> Directory
                    </div>
                    <div class="nav-item" @click="window.open('http://192.168.1.223:30820', '_blank')">
                        <i class="fas fa-key"></i> Vault
                    </div>
                </nav>
            </div>
            
            <!-- Main Content -->
            <div class="main-content">
                <div class="header">
                    <h1>{{getViewTitle()}}</h1>
                    <div style="display: flex; align-items: center; gap: 1rem;">
                        <span class="status-badge" style="background: #dcfce7; color: #166534; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem;">System Healthy</span>
                    </div>
                </div>
                
                <div class="container">
                    <!-- Dashboard -->
                    <div v-if="currentView === 'dashboard'">
                        <div class="grid">
                            <div class="card stat-card">
                                <div class="stat-number">1</div>
                                <div class="stat-label">Active Devices</div>
                            </div>
                            <div class="card stat-card">
                                <div class="stat-number">{{applications.length}}</div>
                                <div class="stat-label">Available Apps</div>
                            </div>
                            <div class="card stat-card">
                                <div class="stat-number">4</div>
                                <div class="stat-label">Active Policies</div>
                            </div>
                            <div class="card stat-card">
                                <div class="stat-number">85%</div>
                                <div class="stat-label">Compliance Score</div>
                            </div>
                        </div>
                        
                        <div class="card" style="margin-top: 2rem;">
                            <h3><i class="fas fa-server"></i> Recently Connected Device</h3>
                            <div style="margin-top: 1rem;">
                                <div class="app-card">
                                    <div class="app-header">
                                        <div>
                                            <h4><i class="fab fa-ubuntu"></i> Ubuntu-CT2001</h4>
                                            <p style="color: #64748b;">Proxmox LXC Container - Servers Group</p>
                                        </div>
                                        <span style="background: #dcfce7; color: #166534; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem;">ONLINE</span>
                                    </div>
                                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-top: 1rem;">
                                        <div>
                                            <div style="font-size: 0.875rem; color: #64748b;">IP Address</div>
                                            <div style="font-weight: 500;">192.168.1.51</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.875rem; color: #64748b;">Installed Apps</div>
                                            <div style="font-weight: 500;">{{getAppInstallCount('docker') + getAppInstallCount('vscode')}} apps</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.875rem; color: #64748b;">Compliance</div>
                                            <div style="font-weight: 500;">85%</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.875rem; color: #64748b;">Last Checkin</div>
                                            <div style="font-weight: 500;">Just now</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Devices -->
                    <div v-if="currentView === 'devices'">
                        <div style="margin-bottom: 2rem; display: flex; gap: 1rem;">
                            <button class="btn btn-primary" @click="showAddDevice = true">
                                <i class="fas fa-plus"></i> Add Device
                            </button>
                            <button class="btn btn-success" @click="refreshDevices()">
                                <i class="fas fa-sync"></i> Refresh
                            </button>
                            <select class="form-select" style="width: auto;" v-model="selectedGroupFilter" @change="filterDevices">
                                <option value="all">All Groups</option>
                                <option v-for="group in deviceGroups" :key="group.id" :value="group.id">
                                    {{group.name}}
                                </option>
                            </select>
                        </div>
                        
                        <div v-for="group in deviceGroups" :key="group.id" class="device-group" v-show="selectedGroupFilter === 'all' || selectedGroupFilter === group.id">
                            <div class="group-header">
                                <div>
                                    <h3>
                                        <i :class="group.icon"></i>
                                        {{group.name}}
                                        <span :class="'group-badge group-' + group.id">{{getDevicesByGroup(group.id).length}}</span>
                                    </h3>
                                    <p style="color: #64748b;">{{group.description}}</p>
                                </div>
                                <button class="btn btn-primary" @click="addDeviceToGroup(group.id)">
                                    <i class="fas fa-plus"></i> Add to Group
                                </button>
                            </div>
                            <div class="group-content">
                                <div v-for="device in getDevicesByGroup(group.id)" :key="device.id" class="device-card">
                                    <div class="device-header">
                                        <div>
                                            <h4>
                                                <i :class="getPlatformIcon(device.platform)"></i>
                                                {{device.name}}
                                            </h4>
                                            <p style="color: #64748b; margin: 0.25rem 0;">{{device.id}}</p>
                                            <p style="color: #64748b; font-size: 0.875rem;">{{device.description}}</p>
                                        </div>
                                        <div style="text-align: right;">
                                            <span class="status-badge" :class="getStatusClass(device.status)">
                                                {{device.status.toUpperCase()}}
                                            </span>
                                            <div style="margin-top: 0.5rem; display: flex; gap: 0.5rem;">
                                                <button class="btn btn-primary" style="padding: 0.5rem;" @click="showDeviceManagement(device)">
                                                    <i class="fas fa-cog"></i>
                                                </button>
                                                <button class="btn btn-warning" style="padding: 0.5rem;" @click="showMoveDevice(device)">
                                                    <i class="fas fa-exchange-alt"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="device-info">
                                        <div class="info-item">
                                            <div class="info-label">Platform</div>
                                            <div class="info-value">{{device.platform}}</div>
                                        </div>
                                        <div class="info-item">
                                            <div class="info-label">IP Address</div>
                                            <div class="info-value">{{device.ip_address}}</div>
                                        </div>
                                        <div class="info-item">
                                            <div class="info-label">Apps Installed</div>
                                            <div class="info-value">{{getDeviceInstalledApps(device.id).length}}</div>
                                        </div>
                                        <div class="info-item">
                                            <div class="info-label">Compliance</div>
                                            <div class="info-value" style="color: #10b981;">{{device.complianceScore}}%</div>
                                        </div>
                                        <div class="info-item">
                                            <div class="info-label">Last Seen</div>
                                            <div class="info-value">{{formatTime(device.lastSeen)}}</div>
                                        </div>
                                    </div>
                                    
                                    <!-- Applications -->  
                                    <div class="installed-apps">
                                        <h5 style="margin-bottom: 0.5rem; color: #374151;">Installed Applications</h5>
                                        <div class="app-list">
                                            <div v-for="app in getDeviceInstalledApps(device.id)" :key="app.app" class="app-badge" :class="'app-' + app.status">
                                                <i :class="getAppIcon(app.app)"></i>
                                                {{getAppName(app.app)}} v{{app.version}}
                                                <span v-if="app.status === 'update-available'" class="update-indicator">!</span>
                                            </div>
                                            <div v-if="getDeviceInstalledApps(device.id).length === 0" style="color: #64748b; font-style: italic; font-size: 0.875rem;">No applications installed</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Users -->
                    <div v-if="currentView === 'users'">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                            <div>
                                <h2><i class="fas fa-users"></i> User Management</h2>
                                <p style="color: #64748b; margin-top: 0.5rem;">Central directory service with LDAP integration</p>
                            </div>
                            <div style="display: flex; gap: 1rem;">
                                <button class="btn btn-primary" onclick="window.open('http://192.168.1.223:30170', '_blank')">
                                    <i class="fas fa-external-link-alt"></i> Open LLDAP
                                </button>
                                <button class="btn btn-success" @click="syncUsers">
                                    <i class="fas fa-sync"></i> Sync LDAP
                                </button>
                            </div>
                        </div>
                        
                        <!-- User Statistics -->
                        <div class="grid" style="margin-bottom: 2rem;">
                            <div class="stat-card">
                                <div class="stat-number">{{users.length}}</div>
                                <div class="stat-label">Total Users</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">{{users.filter(u => u.active).length}}</div>
                                <div class="stat-label">Active Users</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">{{userGroups.length}}</div>
                                <div class="stat-label">User Groups</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">{{users.filter(u => u.lastLogin && isRecent(u.lastLogin)).length}}</div>
                                <div class="stat-label">Recent Logins</div>
                            </div>
                        </div>
                        
                        <!-- User Groups -->
                        <div v-for="group in userGroups" :key="group.id" class="card" style="margin-bottom: 1.5rem;">
                            <div class="group-header" style="margin-bottom: 1rem;">
                                <div>
                                    <h3 style="margin: 0; margin-bottom: 0.25rem;">
                                        <i :class="group.icon"></i>
                                        {{group.name}}
                                        <span :class="'group-badge group-' + group.id" style="margin-left: 0.5rem;">{{getUsersByGroup(group.id).length}}</span>
                                    </h3>
                                    <p style="color: #64748b; margin: 0; font-size: 0.875rem;">{{group.description}}</p>
                                </div>
                                <button class="btn btn-primary" @click="addUserToGroup(group.id)">
                                    <i class="fas fa-plus"></i> Add User
                                </button>
                            </div>
                            
                            <div class="user-grid">
                                <div v-for="user in getUsersByGroup(group.id)" :key="user.id" class="user-card">
                                    <div class="user-header">
                                        <div class="user-avatar">
                                            {{getUserInitials(user.name)}}
                                        </div>
                                        <div class="user-info">
                                            <h4 style="margin: 0; font-size: 1rem;">{{user.name}}</h4>
                                            <p style="margin: 0; color: #64748b; font-size: 0.875rem;">{{user.email}}</p>
                                        </div>
                                        <div class="user-status">
                                            <span class="status-badge" :class="user.active ? 'status-online' : 'status-offline'">
                                                {{user.active ? 'Active' : 'Inactive'}}
                                            </span>
                                        </div>
                                    </div>
                                    <div class="user-details">
                                        <div class="detail-item">
                                            <span class="detail-label">Username:</span>
                                            <span class="detail-value">{{user.username}}</span>
                                        </div>
                                        <div class="detail-item">
                                            <span class="detail-label">Last Login:</span>
                                            <span class="detail-value">{{formatTime(user.lastLogin) || 'Never'}}</span>
                                        </div>
                                        <div class="detail-item">
                                            <span class="detail-label">Created:</span>
                                            <span class="detail-value">{{formatTime(user.created)}}</span>
                                        </div>
                                    </div>
                                    <div class="user-actions">
                                        <button class="btn btn-primary" style="padding: 0.4rem 0.8rem; font-size: 0.875rem;" @click="editUser(user)">
                                            <i class="fas fa-edit"></i> Edit
                                        </button>
                                        <button class="btn btn-warning" style="padding: 0.4rem 0.8rem; font-size: 0.875rem;" @click="resetUserPassword(user)">
                                            <i class="fas fa-key"></i> Reset
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div v-if="getUsersByGroup(group.id).length === 0" style="text-align: center; padding: 2rem; color: #64748b;">
                                <i class="fas fa-users" style="font-size: 2rem; margin-bottom: 0.5rem; opacity: 0.3;"></i>
                                <p>No users in this group</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Policies -->
                    <div v-if="currentView === 'policies'">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                            <h2><i class="fas fa-clipboard-list"></i> Policy Management</h2>
                            <button class="btn btn-primary">
                                <i class="fas fa-plus"></i> Create Policy
                            </button>
                        </div>
                        
                        <div class="grid">
                            <div class="card">
                                <h4><i class="fas fa-sync"></i> Version Management Policy</h4>
                                <p style="color: #64748b; margin: 1rem 0;">Automatic application updates with version control</p>
                                <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                                    <span class="platform-badge platform-universal">Active</span>
                                    <span class="platform-badge platform-linux">Linux</span>
                                </div>
                                <button class="btn btn-primary">Configure</button>
                            </div>
                            
                            <div class="card">
                                <h4><i class="fas fa-shield-alt"></i> Security Update Policy</h4>
                                <p style="color: #64748b; margin: 1rem 0;">Immediate deployment of security patches</p>
                                <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                                    <span class="platform-badge platform-universal">Active</span>
                                    <span class="platform-badge platform-universal">All Platforms</span>
                                </div>
                                <button class="btn btn-primary">Configure</button>
                            </div>
                            
                            <div class="card">
                                <h4><i class="fas fa-calendar"></i> Maintenance Policy</h4>
                                <p style="color: #64748b; margin: 1rem 0;">Scheduled maintenance and system updates</p>
                                <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                                    <span style="background: #fee2e2; color: #991b1b; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem;">Inactive</span>
                                    <span class="platform-badge platform-universal">All Platforms</span>
                                </div>
                                <button class="btn btn-secondary">Configure</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Compliance -->
                    <div v-if="currentView === 'compliance'">
                        <h2><i class="fas fa-shield-alt"></i> Compliance Center</h2>
                        <div class="grid" style="margin-top: 2rem;">
                            <div class="card">
                                <h4>Overall Compliance Score</h4>
                                <div style="text-align: center; margin: 2rem 0;">
                                    <div style="font-size: 3rem; font-weight: bold; color: #10b981;">85%</div>
                                    <div style="color: #64748b;">Good Compliance</div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <h4>Security Status</h4>
                                <div style="margin: 1rem 0;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                        <span>Updates Current</span>
                                        <span style="color: #10b981;">✓</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                        <span>Security Patches</span>
                                        <span style="color: #10b981;">✓</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                        <span>LDAP Integration</span>
                                        <span style="color: #10b981;">✓</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <h4>Policy Compliance</h4>
                                <div style="margin: 1rem 0;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                        <span>Version Policies</span>
                                        <span style="color: #10b981;">Active</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                        <span>Security Policies</span>
                                        <span style="color: #10b981;">Active</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                        <span>Maintenance Policies</span>
                                        <span style="color: #f59e0b;">Scheduled</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Application Store -->
                    <div v-if="currentView === 'apps'">
                        <!-- Store Header -->
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                            <div>
                                <h2>Multi-Platform Application Store</h2>
                                <p style="color: #64748b; margin-top: 0.5rem;">Deploy applications across Windows, macOS, and Linux devices</p>
                            </div>
                            <div style="display: flex; gap: 1rem;">
                                <button class="btn btn-primary">
                                    <i class="fas fa-upload"></i> Upload App
                                </button>
                                <button class="btn btn-success" @click="showBulkDeploy = true">
                                    <i class="fas fa-rocket"></i> Bulk Deploy
                                </button>
                            </div>
                        </div>

                        <!-- Filter Bar -->
                        <div class="filter-bar">
                            <div class="filter-group">
                                <label class="filter-label">Platform</label>
                                <select class="filter-select" v-model="platformFilter">
                                    <option value="all">All Platforms</option>
                                    <option value="windows">Windows</option>
                                    <option value="macos">macOS</option>
                                    <option value="linux">Linux</option>
                                    <option value="universal">Universal</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">Category</label>
                                <select class="filter-select" v-model="categoryFilter">
                                    <option value="all">All Categories</option>
                                    <option value="productivity">Productivity</option>
                                    <option value="development">Development</option>
                                    <option value="browsers">Browsers</option>
                                    <option value="media">Media</option>
                                    <option value="security">Security</option>
                                    <option value="utilities">Utilities</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">Deployment Status</label>
                                <select class="filter-select" v-model="deploymentFilter">
                                    <option value="all">All Apps</option>
                                    <option value="deployed">Deployed</option>
                                    <option value="available">Available</option>
                                </select>
                            </div>
                        </div>

                        <!-- Applications Grid -->
                        <div v-for="category in filteredCategories" :key="category.id" class="category-section">
                            <div class="category-header">
                                <i :class="category.icon" style="font-size: 1.25rem; color: #3b82f6;"></i>
                                <h3 class="category-title">{{category.name}}</h3>
                                <span class="category-count">{{getCategoryApps(category.id).length}}</span>
                            </div>
                            
                            <div class="grid">
                                <div v-for="app in getCategoryApps(category.id)" :key="app.id" class="app-card">
                                    <div class="app-header">
                                        <div style="display: flex;">
                                            <div class="app-icon" :style="'background: ' + app.color">
                                                <i :class="app.icon"></i>
                                            </div>
                                            <div class="app-info">
                                                <div class="app-name">{{app.name}}</div>
                                                <div class="app-version">Version {{app.version}} • {{app.size}}</div>
                                                <div class="app-description">{{app.description}}</div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Platform Support -->
                                    <div class="app-platforms">
                                        <span v-for="platform in app.platforms" :key="platform" 
                                              :class="'platform-badge platform-' + platform">
                                            <i :class="getPlatformIcon(platform)"></i>
                                            {{getPlatformName(platform)}}
                                        </span>
                                    </div>

                                    <!-- App Statistics -->
                                    <div class="app-stats">
                                        <div class="stat-item">
                                            <div class="stat-value">{{getAppInstallCount(app.id)}}</div>
                                            <div class="stat-desc">Installed</div>
                                        </div>
                                        <div class="stat-item">
                                            <div class="stat-value">{{app.rating || '4.5'}}</div>
                                            <div class="stat-desc">Rating</div>
                                        </div>
                                        <div class="stat-item">
                                            <div class="stat-value">{{app.downloads || '1.2k'}}</div>
                                            <div class="stat-desc">Downloads</div>
                                        </div>
                                    </div>

                                    <!-- Action Buttons -->
                                    <div class="app-actions">
                                        <button class="btn btn-primary" @click="showDeploymentModal(app)">
                                            <i class="fas fa-crosshairs"></i> Deploy
                                        </button>
                                        <button class="btn btn-secondary" @click="showAppDetails(app)">
                                            <i class="fas fa-info-circle"></i> Details
                                        </button>
                                        <button v-if="isAppInstalled(app.id)" class="btn btn-warning" @click="updateApp(app)">
                                            <i class="fas fa-sync"></i> Update
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Deployment Modal -->
            <div v-if="showDeployModal" class="modal" @click.self="showDeployModal = false">
                <div class="modal-content">
                    <h3>Deploy {{selectedApp?.name}}</h3>
                    
                    <div style="margin: 1.5rem 0;">
                        <h4 style="margin-bottom: 1rem;">Choose Deployment Method</h4>
                        <div class="deployment-options">
                            <div class="deployment-card" :class="{selected: deploymentMethod === 'targeted'}" 
                                 @click="deploymentMethod = 'targeted'">
                                <h5><i class="fas fa-crosshairs"></i> Targeted Deployment</h5>
                                <p style="font-size: 0.875rem; color: #64748b; margin-top: 0.5rem;">
                                    Select specific devices or groups
                                </p>
                            </div>
                            <div class="deployment-card" :class="{selected: deploymentMethod === 'policy'}" 
                                 @click="deploymentMethod = 'policy'">
                                <h5><i class="fas fa-clipboard-list"></i> Policy-Based</h5>
                                <p style="font-size: 0.875rem; color: #64748b; margin-top: 0.5rem;">
                                    Deploy via existing policies
                                </p>
                            </div>
                        </div>
                    </div>

                    <div v-if="deploymentMethod === 'targeted'">
                        <h4 style="margin-bottom: 1rem;">Platform-Specific Options</h4>
                        <div v-for="platform in selectedApp?.platforms" :key="platform" style="margin-bottom: 1rem;">
                            <h5 style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                <i :class="getPlatformIcon(platform)"></i>
                                {{getPlatformName(platform)}} Deployment
                            </h5>
                            <div style="background: #f8fafc; padding: 1rem; border-radius: 6px; font-size: 0.875rem;">
                                <div v-if="platform === 'windows'">
                                    <strong>Installation Method:</strong> {{getWindowsInstallMethod(selectedApp?.id)}}<br>
                                    <strong>Target Devices:</strong> {{getCompatibleDevices('windows').length}} Windows devices
                                </div>
                                <div v-else-if="platform === 'macos'">
                                    <strong>Installation Method:</strong> {{getMacInstallMethod(selectedApp?.id)}}<br>
                                    <strong>Target Devices:</strong> {{getCompatibleDevices('macos').length}} macOS devices
                                </div>
                                <div v-else-if="platform === 'linux'">
                                    <strong>Installation Method:</strong> {{getLinuxInstallMethod(selectedApp?.id)}}<br>
                                    <strong>Target Devices:</strong> {{getCompatibleDevices('linux').length}} Linux devices
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                        <button class="btn btn-primary" @click="deployApplication()">
                            <i class="fas fa-rocket"></i> Deploy Application
                        </button>
                        <button class="btn btn-secondary" @click="showDeployModal = false">Cancel</button>
                    </div>
                </div>
            </div>

            <!-- Notifications -->
            <div v-for="notification in notifications" :key="notification.id" 
                 :class="'notification ' + notification.type + (notification.show ? ' show' : '')">
                {{notification.message}}
            </div>
        </div>

        <script>
            const { createApp } = Vue;
            
            createApp({
                data() {
                    return {
                        currentView: 'apps',
                        platformFilter: 'all',
                        categoryFilter: 'all',
                        deploymentFilter: 'all',
                        showDeployModal: false,
                        selectedApp: null,
                        deploymentMethod: 'targeted',
                        notifications: [],
                        ws: null, // WebSocket connection

                        // Device Management
                        devices: [
                            {
                                id: 'CT2001',
                                name: 'Ubuntu-CT2001',
                                platform: 'linux',
                                os: 'Ubuntu',
                                osVersion: '25.10',
                                status: 'online',
                                groupId: 'servers',
                                ip_address: '192.168.1.51',
                                complianceScore: 85,
                                lastSeen: new Date(),
                                description: 'Proxmox LXC Container with LDAP integration'
                            }
                        ],
                        deviceGroups: [
                            {
                                id: 'servers',
                                name: 'Server Devices',
                                description: 'Production and development servers',
                                icon: 'fas fa-server',
                                color: '#1e40af'
                            },
                            {
                                id: 'workstations',
                                name: 'Workstations',
                                description: 'Desktop computers and workstations',
                                icon: 'fas fa-desktop',
                                color: '#166534'
                            },
                            {
                                id: 'mobile',
                                name: 'Mobile Devices',
                                description: 'Smartphones and tablets',
                                icon: 'fas fa-mobile-alt',
                                color: '#7c3aed'
                            }
                        ],
                        selectedGroupFilter: 'all',

                        // User Management
                        users: [
                            {
                                id: 'admin',
                                name: 'Administrator',
                                username: 'admin',
                                email: 'admin@opendirectory.local',
                                active: true,
                                groups: ['admin'],
                                lastLogin: new Date(),
                                created: new Date('2024-01-01')
                            },
                            {
                                id: 'user1',
                                name: 'John Doe',
                                username: 'jdoe',
                                email: 'jdoe@opendirectory.local',
                                active: true,
                                groups: ['user'],
                                lastLogin: new Date(Date.now() - 86400000), // 1 day ago
                                created: new Date('2024-01-15')
                            }
                        ],
                        userGroups: [
                            {
                                id: 'admin',
                                name: 'Administrators',
                                description: 'System administrators with full access',
                                icon: 'fas fa-user-shield'
                            },
                            {
                                id: 'user',
                                name: 'Standard Users',
                                description: 'Regular users with limited access',
                                icon: 'fas fa-user'
                            },
                            {
                                id: 'guest',
                                name: 'Guest Users',
                                description: 'Temporary access users',
                                icon: 'fas fa-user-friends'
                            }
                        ],

                        // Device Installations
                        deviceInstallations: {
                            'CT2001': [
                                {
                                    app: 'docker',
                                    name: 'Docker',
                                    version: '24.0.7',
                                    status: 'installed',
                                    lastUpdate: '2024-01-15'
                                },
                                {
                                    app: 'vscode',
                                    name: 'Visual Studio Code',
                                    version: '1.85.1',
                                    status: 'update-available',
                                    lastUpdate: '2024-01-10'
                                }
                            ]
                        },
                        
                        // Multi-platform applications
                        applications: [
                            // Productivity
                            {
                                id: 'chrome',
                                name: 'Google Chrome',
                                version: '120.0.6099.109',
                                description: 'Fast, secure web browser with sync across devices',
                                category: 'browsers',
                                size: '85 MB',
                                platforms: ['windows', 'macos', 'linux'],
                                icon: 'fab fa-chrome',
                                color: 'linear-gradient(135deg, #4285f4, #0f9d58)',
                                rating: '4.2',
                                downloads: '2.1B'
                            },
                            {
                                id: 'firefox',
                                name: 'Mozilla Firefox',
                                version: '121.0',
                                description: 'Open-source web browser focused on privacy',
                                category: 'browsers',
                                size: '56 MB',
                                platforms: ['windows', 'macos', 'linux'],
                                icon: 'fab fa-firefox',
                                color: 'linear-gradient(135deg, #ff9500, #ff7139)',
                                rating: '4.0',
                                downloads: '220M'
                            },
                            {
                                id: 'vscode',
                                name: 'Visual Studio Code',
                                version: '1.85.1',
                                description: 'Lightweight but powerful source code editor',
                                category: 'development',
                                size: '95 MB',
                                platforms: ['windows', 'macos', 'linux'],
                                icon: 'fas fa-code',
                                color: 'linear-gradient(135deg, #007acc, #005a9e)',
                                rating: '4.8',
                                downloads: '15M'
                            },
                            {
                                id: 'docker-desktop',
                                name: 'Docker Desktop',
                                version: '4.26.1',
                                description: 'Containerization platform for developers',
                                category: 'development',
                                size: '540 MB',
                                platforms: ['windows', 'macos'],
                                icon: 'fab fa-docker',
                                color: 'linear-gradient(135deg, #2496ed, #0db7ed)',
                                rating: '4.1',
                                downloads: '50M'
                            },
                            {
                                id: 'docker',
                                name: 'Docker Engine',
                                version: '24.0.7',
                                description: 'Container runtime for Linux servers',
                                category: 'development',
                                size: '45 MB',
                                platforms: ['linux'],
                                icon: 'fab fa-docker',
                                color: 'linear-gradient(135deg, #2496ed, #0db7ed)',
                                rating: '4.5',
                                downloads: '100M'
                            },
                            
                            // Windows Specific
                            {
                                id: 'office365',
                                name: 'Microsoft 365',
                                version: '16.0.17126.20132',
                                description: 'Complete office suite with Word, Excel, PowerPoint',
                                category: 'productivity',
                                size: '3.2 GB',
                                platforms: ['windows'],
                                icon: 'fab fa-microsoft',
                                color: 'linear-gradient(135deg, #d83b01, #ff8c00)',
                                rating: '4.0',
                                downloads: '1B'
                            },
                            {
                                id: 'teams',
                                name: 'Microsoft Teams',
                                version: '1.6.00.32462',
                                description: 'Collaboration and communication platform',
                                category: 'productivity',
                                size: '140 MB',
                                platforms: ['windows', 'macos'],
                                icon: 'fab fa-microsoft',
                                color: 'linear-gradient(135deg, #6264a7, #464775)',
                                rating: '3.8',
                                downloads: '250M'
                            },
                            
                            // macOS Specific
                            {
                                id: 'xcode',
                                name: 'Xcode',
                                version: '15.1',
                                description: 'Complete developer toolset for Apple platforms',
                                category: 'development',
                                size: '12.6 GB',
                                platforms: ['macos'],
                                icon: 'fas fa-hammer',
                                color: 'linear-gradient(135deg, #147efb, #0052cc)',
                                rating: '3.4',
                                downloads: '10M'
                            },
                            {
                                id: 'homebrew',
                                name: 'Homebrew',
                                version: '4.2.0',
                                description: 'Package manager for macOS',
                                category: 'utilities',
                                size: '15 MB',
                                platforms: ['macos'],
                                icon: 'fas fa-beer',
                                color: 'linear-gradient(135deg, #fbcb4a, #f7a500)',
                                rating: '4.6',
                                downloads: '4M'
                            },
                            
                            // Security
                            {
                                id: 'bitdefender',
                                name: 'Bitdefender Antivirus',
                                version: '27.0.12.80',
                                description: 'Advanced threat protection for all platforms',
                                category: 'security',
                                size: '2.1 GB',
                                platforms: ['windows', 'macos'],
                                icon: 'fas fa-shield-alt',
                                color: 'linear-gradient(135deg, #ed1c24, #b71c1c)',
                                rating: '4.3',
                                downloads: '500M'
                            },
                            
                            // Media
                            {
                                id: 'vlc',
                                name: 'VLC Media Player',
                                version: '3.0.20',
                                description: 'Free multimedia player for all formats',
                                category: 'media',
                                size: '42 MB',
                                platforms: ['windows', 'macos', 'linux'],
                                icon: 'fas fa-play-circle',
                                color: 'linear-gradient(135deg, #ff8f00, #f57c00)',
                                rating: '4.7',
                                downloads: '3B'
                            }
                        ],

                        // Application categories
                        categories: [
                            { id: 'productivity', name: 'Productivity', icon: 'fas fa-briefcase' },
                            { id: 'development', name: 'Development', icon: 'fas fa-code' },
                            { id: 'browsers', name: 'Web Browsers', icon: 'fas fa-globe' },
                            { id: 'media', name: 'Media & Entertainment', icon: 'fas fa-play' },
                            { id: 'security', name: 'Security', icon: 'fas fa-shield-alt' },
                            { id: 'utilities', name: 'Utilities', icon: 'fas fa-wrench' }
                        ],

                        // Simulated device installations
                        deviceInstallations: {
                            'CT2001': [
                                { app: 'docker', platform: 'linux', version: '24.0.7' },
                                { app: 'vscode', platform: 'linux', version: '1.85.1' }
                            ]
                        }
                    }
                },
                mounted() {
                    this.connectWebSocket();
                    this.loadUsers();
                    this.refreshDevices();
                },
                computed: {
                    filteredCategories() {
                        return this.categories.filter(category => {
                            const categoryApps = this.getCategoryApps(category.id);
                            return categoryApps.length > 0;
                        });
                    }
                },
                methods: {
                    setView(view) {
                        this.currentView = view;
                    },
                    getViewTitle() {
                        const titles = {
                            dashboard: 'Dashboard',
                            devices: 'Device Management',
                            apps: 'Multi-Platform Application Store',
                            policies: 'Policy Management'
                        };
                        return titles[this.currentView] || 'Dashboard';
                    },
                    
                    // Platform methods
                    getPlatformIcon(platform) {
                        const icons = {
                            windows: 'fab fa-windows',
                            macos: 'fab fa-apple',
                            linux: 'fab fa-linux',
                            universal: 'fas fa-globe'
                        };
                        return icons[platform] || 'fas fa-desktop';
                    },
                    getPlatformName(platform) {
                        const names = {
                            windows: 'Windows',
                            macos: 'macOS',
                            linux: 'Linux',
                            universal: 'Universal'
                        };
                        return names[platform] || platform;
                    },
                    
                    // Installation methods per platform
                    getWindowsInstallMethod(appId) {
                        const methods = {
                            'chrome': 'MSI Package',
                            'firefox': 'EXE Installer',
                            'vscode': 'MSI Package',
                            'office365': 'Click-to-Run',
                            'teams': 'MSI Package',
                            'bitdefender': 'EXE Installer'
                        };
                        return methods[appId] || 'Chocolatey Package';
                    },
                    getMacInstallMethod(appId) {
                        const methods = {
                            'chrome': 'DMG Package',
                            'firefox': 'DMG Package', 
                            'vscode': 'ZIP Archive',
                            'xcode': 'App Store',
                            'homebrew': 'Shell Script',
                            'teams': 'PKG Installer',
                            'bitdefender': 'DMG Package'
                        };
                        return methods[appId] || 'Homebrew Formula';
                    },
                    getLinuxInstallMethod(appId) {
                        const methods = {
                            'chrome': 'DEB Package',
                            'firefox': 'Snap Package',
                            'vscode': 'DEB Package',
                            'docker': 'APT Repository',
                            'vlc': 'APT Package'
                        };
                        return methods[appId] || 'APT Package';
                    },
                    
                    // App filtering and categorization
                    getCategoryApps(categoryId) {
                        let apps = this.applications.filter(app => app.category === categoryId);
                        
                        // Platform filter
                        if (this.platformFilter !== 'all') {
                            apps = apps.filter(app => app.platforms.includes(this.platformFilter));
                        }
                        
                        // Deployment filter
                        if (this.deploymentFilter !== 'all') {
                            if (this.deploymentFilter === 'deployed') {
                                apps = apps.filter(app => this.isAppInstalled(app.id));
                            } else if (this.deploymentFilter === 'available') {
                                apps = apps.filter(app => !this.isAppInstalled(app.id));
                            }
                        }
                        
                        return apps;
                    },
                    
                    // Installation status
                    isAppInstalled(appId) {
                        for (const deviceApps of Object.values(this.deviceInstallations)) {
                            if (deviceApps.find(installation => installation.app === appId)) {
                                return true;
                            }
                        }
                        return false;
                    },
                    getAppInstallCount(appId) {
                        let count = 0;
                        for (const deviceApps of Object.values(this.deviceInstallations)) {
                            if (deviceApps.find(installation => installation.app === appId)) {
                                count++;
                            }
                        }
                        return count;
                    },
                    
                    // Device compatibility
                    getCompatibleDevices(platform) {
                        // Simulated device data
                        const allDevices = [
                            { id: 'WIN-PC-001', platform: 'windows' },
                            { id: 'MAC-001', platform: 'macos' },
                            { id: 'CT2001', platform: 'linux' }
                        ];
                        return allDevices.filter(device => device.platform === platform);
                    },
                    
                    // Deployment actions
                    showDeploymentModal(app) {
                        this.selectedApp = app;
                        this.deploymentMethod = 'targeted';
                        this.showDeployModal = true;
                    },
                    deployApplication() {
                        if (!this.selectedApp) return;
                        
                        const platforms = this.selectedApp.platforms;
                        let deploymentSummary = `Deploying ${this.selectedApp.name} to `;
                        
                        platforms.forEach((platform, index) => {
                            const deviceCount = this.getCompatibleDevices(platform).length;
                            deploymentSummary += `${deviceCount} ${this.getPlatformName(platform)} device(s)`;
                            if (index < platforms.length - 1) deploymentSummary += ', ';
                        });
                        
                        this.showNotification(deploymentSummary, 'success');
                        this.showDeployModal = false;
                        
                        // Deploy to real devices
                        this.deployToDevices();
                    },
                    showAppDetails(app) {
                        this.showNotification(`Showing details for ${app.name}`, 'success');
                    },
                    updateApp(app) {
                        this.showNotification(`Updating ${app.name} on all devices...`, 'success');
                    },
                    
                    // Notifications
                    showNotification(message, type = 'success') {
                        const notification = {
                            id: Date.now(),
                            message,
                            type,
                            show: false
                        };
                        
                        this.notifications.push(notification);
                        
                        setTimeout(() => {
                            notification.show = true;
                        }, 100);
                        
                        setTimeout(() => {
                            notification.show = false;
                            setTimeout(() => {
                                const index = this.notifications.indexOf(notification);
                                if (index > -1) {
                                    this.notifications.splice(index, 1);
                                }
                            }, 300);
                        }, 3000);
                    },

                    // Device Management Functions
                    getDevicesByGroup(groupId) {
                        return this.devices.filter(device => device.groupId === groupId);
                    },
                    getDeviceInstalledApps(deviceId) {
                        return this.deviceInstallations[deviceId] || [];
                    },
                    getPlatformIcon(platform) {
                        const icons = {
                            'linux': 'fab fa-linux',
                            'windows': 'fab fa-windows', 
                            'macos': 'fab fa-apple',
                            'ubuntu': 'fab fa-ubuntu'
                        };
                        return icons[platform] || 'fas fa-desktop';
                    },
                    getStatusClass(status) {
                        return status === 'online' ? 'status-online' : 'status-offline';
                    },
                    async refreshDevices() {
                        this.showNotification('Refreshing device status...', 'success');
                        try {
                            const response = await fetch('http://localhost:3001/api/devices');
                            const result = await response.json();
                            if (result.success) {
                                this.devices = result.data;
                                this.showNotification('Devices refreshed successfully!', 'success');
                            }
                        } catch (error) {
                            console.error('Failed to refresh devices:', error);
                            this.showNotification('Failed to refresh devices', 'error');
                        }
                    },
                    filterDevices() {
                        // This would filter devices based on selectedGroupFilter
                    },
                    showDeviceManagement(device) {
                        this.showNotification(`Managing device: ${device.name}`, 'success');
                    },
                    showMoveDevice(device) {
                        this.showNotification(`Moving device: ${device.name}`, 'success');
                    },
                    addDeviceToGroup(groupId) {
                        this.showNotification(`Adding device to ${this.getGroupName(groupId)}`, 'success');
                    },
                    formatTime(date) {
                        if (!date) return 'Unknown';
                        const d = new Date(date);
                        return d.toLocaleString();
                    },
                    
                    // User Management Functions
                    getUsersByGroup(groupId) {
                        return this.users.filter(user => user.groups.includes(groupId));
                    },
                    getUserInitials(name) {
                        if (!name) return 'U';
                        return name.split(' ').map(n => n[0]).join('').toUpperCase().substr(0, 2);
                    },
                    async syncUsers() {
                        this.showNotification('Syncing users with LDAP...', 'success');
                        try {
                            const response = await fetch('http://localhost:3001/api/users/sync', {
                                method: 'POST'
                            });
                            const result = await response.json();
                            if (result.success) {
                                this.showNotification(`Synced ${result.data.syncedCount} users from LDAP`, 'success');
                                this.loadUsers();
                            }
                        } catch (error) {
                            console.error('Failed to sync users:', error);
                            this.showNotification('Failed to sync users', 'error');
                        }
                    },
                    addUserToGroup(groupId) {
                        this.showNotification(`Adding user to ${groupId}`, 'success');
                    },
                    editUser(user) {
                        this.showNotification(`Editing user: ${user.name}`, 'success');
                    },
                    resetUserPassword(user) {
                        this.showNotification(`Resetting password for: ${user.name}`, 'success');
                    },
                    isRecent(date) {
                        if (!date) return false;
                        const now = new Date();
                        const loginDate = new Date(date);
                        const diffDays = (now - loginDate) / (1000 * 60 * 60 * 24);
                        return diffDays <= 7; // Within last 7 days
                    },
                    
                    // API Integration Methods
                    async loadUsers() {
                        try {
                            const response = await fetch('http://localhost:3001/api/users');
                            const result = await response.json();
                            if (result.success) {
                                this.users = result.data;
                            }
                        } catch (error) {
                            console.error('Failed to load users:', error);
                        }
                    },
                    
                    async deployToDevices() {
                        try {
                            const response = await fetch(`http://localhost:3001/api/devices/CT2001/apps/install`, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({
                                    appId: this.selectedApp.id,
                                    appName: this.selectedApp.name,
                                    version: this.selectedApp.version
                                })
                            });
                            
                            const result = await response.json();
                            if (result.success) {
                                this.showNotification(result.message, 'success');
                                this.refreshDevices();
                            } else {
                                this.showNotification(result.error, 'error');
                            }
                        } catch (error) {
                            console.error('Deployment failed:', error);
                            this.showNotification('Deployment failed', 'error');
                        }
                    },
                    
                    // WebSocket Connection
                    connectWebSocket() {
                        if (this.ws) return;
                        
                        this.ws = new WebSocket('ws://localhost:3001');
                        
                        this.ws.onopen = () => {
                            console.log('WebSocket connected');
                        };
                        
                        this.ws.onmessage = (event) => {
                            const message = JSON.parse(event.data);
                            this.handleWebSocketMessage(message);
                        };
                        
                        this.ws.onclose = () => {
                            console.log('WebSocket disconnected');
                            setTimeout(() => this.connectWebSocket(), 5000);
                        };
                    },
                    
                    handleWebSocketMessage(message) {
                        switch(message.type) {
                            case 'device_status':
                                this.devices = message.data;
                                break;
                            case 'device_updated':
                                const deviceIndex = this.devices.findIndex(d => d.id === message.data.id);
                                if (deviceIndex >= 0) {
                                    this.devices[deviceIndex] = message.data;
                                }
                                break;
                            case 'app_installed':
                                this.showNotification(`App installed on ${message.data.deviceId}`, 'success');
                                break;
                            case 'device_heartbeat':
                                const device = this.devices.find(d => d.id === message.data.deviceId);
                                if (device) {
                                    device.status = message.data.status;
                                    device.lastSeen = message.data.lastSeen;
                                }
                                break;
                        }
                    },

                    // Utility Functions
                    getGroupName(groupId) {
                        const group = this.deviceGroups.find(g => g.id === groupId);
                        return group ? group.name : 'Unknown Group';
                    },
                    getAppName(appId) {
                        const app = this.applications.find(a => a.id === appId);
                        return app ? app.name : appId;
                    },
                    getAppIcon(appId) {
                        const app = this.applications.find(a => a.id === appId);
                        return app ? app.icon : 'fas fa-cube';
                    }
                }
            }).mount('#app');
        </script>
    </body>
    </html>